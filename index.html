<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bouquet Simple App</title>
<base href="https://api.squidsolutions.com/apps/dev/bouquet-app-simple/">

<!-- bower:css -->
<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css" />
<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.css" />
<link rel="stylesheet" href="bower_components/squid_api_core_widgets/dist/squid_api_core-widgets.css" />
<link rel="stylesheet" href="bower_components/bootstrap-multiselect/dist/css/bootstrap-multiselect.css" />
<link rel="stylesheet" href="bower_components/metrics-graphics/dist/metricsgraphics.css" />
<link rel="stylesheet" href="bower_components/squid_api_data_widgets/dist/squid_api_data-widgets.css" />
<link rel="stylesheet" href="bower_components/bootstrap-daterangepicker/daterangepicker-bs3.css" />
<link rel="stylesheet" href="bower_components/squid_api_filters_widget/dist/squid_api_filters-widgets.css" />
<link rel="stylesheet" href="bower_components/data_tables/media/css/jquery.dataTables.css" />
<link rel="stylesheet" href="bower_components/data_tables_css/index.css" />
<link rel="stylesheet" href="bower_components/bootstrap-duallistbox/src/bootstrap-duallistbox.css" />
<link rel="stylesheet" href="bower_components/squid_api_admin_widgets/dist/squid_api_admin-widgets.css" />
<!-- endbower -->

<!-- bower:js -->
<script src="bower_components/jquery/jquery.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
<script src="bower_components/underscore/underscore.js"></script>
<script src="bower_components/backbone/backbone.js"></script>
<script src="bower_components/urijs/src/URI.js"></script>
<script src="bower_components/backbone-nested-models/backbone-nested-models.js"></script>
<script src="bower_components/semver/semver.browser.js"></script>
<script src="bower_components/squid_api/dist/squid_api.js"></script>
<script src="bower_components/handlebars/handlebars.js"></script>
<script src="bower_components/squid_api_core_widgets/dist/squid_api_core-widgets.js"></script>
<script src="bower_components/bootstrap-multiselect/dist/js/bootstrap-multiselect.js"></script>
<script src="bower_components/d3/d3.js"></script>
<script src="bower_components/moment/moment.js"></script>
<script src="bower_components/backbone-forms/distribution/backbone-forms.js"></script>
<script src="bower_components/backbone.bootstrap-modal/src/backbone.bootstrap-modal.js"></script>
<script src="bower_components/backbone-deep-model/dist/backbone-deep-model.js"></script>
<script src="bower_components/metrics-graphics/dist/metricsgraphics.js"></script>
<script src="bower_components/squid_api_data_widgets/dist/squid_api_data-widgets.js"></script>
<script src="bower_components/jquery-ui/ui/jquery-ui.js"></script>
<script src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
<script src="bower_components/squid_api_filters_widget/dist/squid_api_filters-widget.js"></script>
<script src="bower_components/data_tables/media/js/jquery.dataTables.js"></script>
<script src="bower_components/data_tables_js/index.js"></script>
<script src="bower_components/bootstrap-duallistbox/src/jquery.bootstrap-duallistbox.js"></script>
<script src="bower_components/clipboard/dist/clipboard.js"></script>
<script src="bower_components/squid_api_admin_widgets/dist/squid_api_admin-widgets.js"></script>
<!-- endbower -->
</head>

<body>
	<div class="container" id="header">
		<div class="row">
			<div class="col-md-9">
				<div id="status"></div>
			</div>
			<div class="col-md-3">
				<div id="login"></div>
			</div>
		</div>
	</div>
	<div class="container" id="main">
		<div class="row">
			<div class="col-md-12">
				<h2>Simple App</h2>
			</div>
		</div>
		<div class="row">
			<div class="col-md-3">
				<div id="date"></div>
			</div>
			<div class="col-md-1">
				<div id="filters"></div>
			</div>
			<div class="col-md-8">
				<div id="selected"></div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<div id="data"></div>
			</div>
		</div>
	</div>
	
	<script>
		$( document ).ready(function() {

			/*
			 * API Setup
			 */
			var API = squid_api.setup({
				"apiUrl" : "demo.openbouquet.io",
				"clientId" : "simple-app",
				"config" : {
					"project" : "dvdrental",
					"bookmark" : null
				},
			});

			/*
			 * Controller part
			 */
			new API.controller.FiltersController();
			var analysis = (new API.controller.AnalysisController()).model;

			/*
			 * Declare the views
			 */
			new API.view.LoginView();
			new API.view.StatusView();
			new API.view.CategoricalView({
				el : '#filters',
				filterSelected : '#selected',
				popup : true
			});
			new API.view.DateSelectionWidget({
				el : '#date'
			});
			new API.view.BookmarkWidget({
				el : '#bookmark'
			});

			analysis.on("change", function() {
				if (this.get("results")) {
					/*
					 Sample D3 Table to display the data
					 */

					// remove any existing tables created
					d3.select('#data table').remove();

					// specify the rendering div
					var container = d3.select('#data');

					// create table & append table headers
					container.append('table')
							.append('thead')
							.append('tr');

					// store our created table
					var table = container.select('table');

					// insert table header data
					table.select("thead tr")
							.selectAll("th")
							.data(this.get("results").cols)
							.enter()
							.append("th")
							.text(function(d) {
								return d.name;
							});

					// insert table body
					table.append('tbody');

					// insert table body data
					table.select("tbody")
							.selectAll("tr")
							.data(this.get("results").rows)
							.enter()
							.append("tr").selectAll("td")
							.data(function(d) {
								return d.v;
							})
							.enter()
							.append("td")
							.text(function(d) {
								return d;
							});
				}
			});

			/*
			 * Start the App
			 */
			API.init();
		});


	</script>
</body>
</html>
